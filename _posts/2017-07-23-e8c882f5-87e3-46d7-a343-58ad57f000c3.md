---
publisher: {}
datePublished: '2017-07-23T15:12:56.833Z'
dateModified: '2017-07-23T15:12:56.552Z'
via: {}
description: ''
title: ''
sourcePath: _posts/2017-07-23-e8c882f5-87e3-46d7-a343-58ad57f000c3.md
inFeed: true
author: []
isBasedOnUrl: >-
  https://the-grid.github.io/ed-userhtml/?g=eJyNVG1v2zYQ_q5fcTUCSAZqKV2TrHMcBdmcdd6cNJnnBUVbpBR1lhhRokJSceWh_e0lxchL0G7IB0nE3T0P7-U5UVHWQqEEibcNkwik0flu1L1HdV6PB1_2w92B1yiEE2t8v5j-8b47HXreThcHR1Dh2rmDdx6An4qSsMqHoxj8IlmRkvE27GJDKkr_uY2hnGGlr1nqwt6-3rw6n53epH_rn7L6xWxvf7NpVievF1P-4zS5ePEIpJBK1A64l59mp1fLm4Ppmfphc8oOfl-wdv_gTLw8v1SXu_ONytrL25cFFnWxKbLz271f5p_KX-U6U7_9PBetI5aYmuqpvm4kc7y51rUaR9HbN8s_r08uLiJKOE8ILRyANKlJheLj4G-LjUznJKtWwsFqlIopW_a1FgW6HmnZ4CMvoRSV-r8IiSuJKv8m5MPw0Isi6HMNzQg9LwxDb8fmMTN5mGm5sY3iDPXSWAOD8dgKgmfboCH8Y24DMFRXCDm5Q6gEWC_YWnpf3zXQAuYiY5X3GZAbqWzRyw6iOlmZyTFKNKa9c0FayJFzYfHbu9_5FSnR_9BH1aZ9GrjIRKMhabQW5hpv8mw0Mrmk-MnWCKNR7HkTApQTpY4Gia7APCODLYlsuzPP3Mfm2Z0SLmgxiBcsq2bVJCKx7VzdJJzRiNR1eKOMwoNU0KY0qQ9DiSRtg1VTUc1EFbge3REJa0ys-O_3wI3-ytkC1wm3EOP_3AYAp-zZdPzEVYBt85eSGdB6vQ4LoSqUSSOVRlY9IO_FOoaPT1Dqx55f1aJS-FdbG6BPRYr3dIqKzmTeFUvNgMSKcfSN77OVEsBO4IfbXvvD0BRHi387h728MKwl3pm6p7giDddWidZ-39AuNyHZBp3Dsttncmxl_QRVH8feJNcljw14koi07fWRixIHcXfXJGV3cccISPPv6BCO40lkgyxJZFkMa-RodziRZjn4Qgvz73TzP2vnD4w2je_8JomUpA16idtS7NFXFtKt8yPm5w8Dh8PDrzbvykA
starred: true
datePublishedOriginal: '2017-07-23T13:20:46.576Z'
_type: MediaObject

---
flask
    requests
    auth0-python
    /public/app.js
    
    $(document).ready(function() {
      var auth = new auth0.WebAuth({
        domain: 'kbfamily.auth0.com',
        clientID: 'YGz8NIEjdVt9gp1I45zzufAGSDl7DbP1'
       });
    
    
        $('.btn-login').click(function(e) {
          e.preventDefault();
          auth.authorize({
            audience: 'https://' + 'kbfamily.auth0.com' + '/userinfo',
            scope: 'openid profile',
            responseType: 'code',
            redirectUri: 'www.kosnerburstein.com'
          });
        });
    });  
    # server.py
    
    import os
    import json
    
    from auth0.v3.authentication import GetToken
    from auth0.v3.authentication import Users
    from dotenv import load_dotenv
    from flask import Flask
    from flask import redirect
    from flask import render_template
    from flask import request
    from flask import send_from_directory
    from flask import session
    
    # Here we're using the /callback route.
    @app.route('/callback')
    def callback_handling():
        code = request.args.get('code')
        get_token = GetToken('kbfamily.auth0.com')
        auth0_users = Users('kbfamily.auth0.com')
        token = get_token.authorization_code('YGz8NIEjdVt9gp1I45zzufAGSDl7DbP1',
                                             '4hEgEWUj6DMs2zEi6JSiy56Mo3NQsQ0LzsgyQq3kekpkzkgNq4CLxmFrwgsHBLoy', code, 'www.kosnerburstein.com')
        user_info = auth0_users.userinfo(token['access_token'])
        session['profile'] = json.loads(user_info)
        return redirect('/dashboard')
    @app.route("/dashboard")
    @requires_auth
    def dashboard():
        return render_template('dashboard.html', user=session['profile'])
    <div>
      <img class="avatar" src="{{user['picture']}}"/>
      <h2>Welcome {{user['nickname']}}</h2>
    </div>
    @app.route('/logout')
    def logout():
        session.clear()
        parsed_base_url = urlparse('www.kosnerburstein.com')
        base_url = parsed_base_url.scheme + '://' + parsed_base_url.netloc
        return redirect('https://%s/v2/logout?returnTo=%s&client_id=%s' % ('kbfamily.auth0.com', base_url, 'YGz8NIEjdVt9gp1I45zzufAGSDl7DbP1'))
    def requires_auth(f):
      @wraps(f)
      def decorated(*args, **kwargs):
        if 'profile' not in session:
          # Redirect to Login page here
          return redirect('/')
        return f(*args, **kwargs)
    
      return decorated